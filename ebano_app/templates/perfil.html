{% extends "base.html" %}

{% block title %}Mi Perfil | Ã‰bano{% endblock %}

{% block content %}
<section class="perfil-seccion">
    <div class="perfil-container">
        <h1 class="titulo-perfil">Mi Perfil</h1>
        <p class="subtitulo-perfil">Administra tu informaciÃ³n personal y seguridad</p>

        <!-- Mostrar mensajes flash -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
              {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <!-- ========================================
             SECCIÃ“N 1: DATOS PERSONALES
        ========================================= -->
        <div class="seccion-perfil">
            <h2 class="subtitulo-seccion">
                <span class="icono-seccion">ğŸ‘¤</span> Datos Personales
            </h2>
            
            <form method="post" action="{{ url_for('perfil_editar_datos') }}" class="form-perfil">
                <div class="form-grupo">
                    <label for="nombre">Nombre completo</label>
                    <input id="nombre" name="nombre" type="text" required value="{{ datos.nombre }}" placeholder="Tu nombre completo">
                </div>

                <div class="form-grupo">
                    <label for="correo">Correo electrÃ³nico</label>
                    <input id="correo" name="correo" type="email" value="{{ datos.correo }}" readonly title="El correo no se puede modificar">
                    <small class="ayuda-texto">El correo no se puede modificar por seguridad</small>
                </div>

                <div class="form-grupo doble">
                    <div>
                        <label for="telefono">TelÃ©fono</label>
                        <input id="telefono" name="telefono" type="text" value="{{ datos.telefono }}" placeholder="Ej: +57 300 1234567">
                    </div>
                    <div>
                        <label for="direccion">DirecciÃ³n</label>
                        <input id="direccion" name="direccion" type="text" value="{{ datos.direccion }}" placeholder="Calle, nÃºmero, ciudad">
                    </div>
                </div>

                <div class="form-acciones">
                    <button type="submit" class="boton-principal">ğŸ’¾ Guardar cambios</button>
                </div>
            </form>
        </div>

        <!-- Separador visual -->
        <hr class="separador-perfil">

        <!-- ========================================
             SECCIÃ“N 2: CAMBIAR CONTRASEÃ‘A
        ========================================= -->
        <div class="seccion-perfil">
            <h2 class="subtitulo-seccion">
                <span class="icono-seccion">ğŸ”’</span> Seguridad - Cambiar ContraseÃ±a
            </h2>
            
            <div class="alerta-info">
                <strong>âš ï¸ Importante:</strong> DespuÃ©s de cambiar tu contraseÃ±a, deberÃ¡s iniciar sesiÃ³n nuevamente.
            </div>

            <form method="post" action="{{ url_for('perfil_cambiar_contrasena') }}" class="form-perfil">
                <div class="form-grupo">
                    <label for="contrasena_actual">ContraseÃ±a actual</label>
                    <input id="contrasena_actual" name="contrasena_actual" type="password" required placeholder="Ingresa tu contraseÃ±a actual">
                </div>

                <div class="form-grupo">
                    <label for="contrasena_nueva">Nueva contraseÃ±a</label>
                    <input id="contrasena_nueva" name="contrasena_nueva" type="password" required minlength="6" placeholder="MÃ­nimo 6 caracteres">
                    <small class="ayuda-texto">MÃ­nimo 6 caracteres</small>
                </div>

                <div class="form-grupo">
                    <label for="contrasena_confirmar">Confirmar nueva contraseÃ±a</label>
                    <input id="contrasena_confirmar" name="contrasena_confirmar" type="password" required minlength="6" placeholder="Repite la nueva contraseÃ±a">
                </div>

                <div class="form-acciones">
                    <button type="submit" class="boton-principal boton-seguridad">ğŸ”‘ Cambiar contraseÃ±a</button>
                </div>
            </form>
        </div>

        <!-- BotÃ³n volver -->
        <div class="form-acciones" style="margin-top: 2rem; justify-content: center;">
            <a href="{{ url_for('dashboard_usuario') }}" class="boton-secundario">â† Volver al panel</a>
        </div>
    </div>
</section>
{% endblock %}